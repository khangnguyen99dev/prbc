"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1161],{12:(y,f,r)=>{r.d(f,{w:()=>M});var t=r(1571),_=r(6895);function Z(n,l){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const c=l.$implicit;t.xp6(1),t.Oqu(c)}}function x(n,l){if(1&n&&(t.TgZ(0,"div",2)(1,"div",3),t._uU(2," Error "),t.qZA(),t.TgZ(3,"div",4),t.YNc(4,Z,2,1,"p",5),t.qZA(),t._UZ(5,"div",6),t.qZA()),2&n){const c=t.oxw(2);t.xp6(4),t.Q6J("ngForOf",c.errorMessages)}}function e(n,l){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const c=l.$implicit;t.xp6(1),t.Oqu(c)}}function g(n,l){if(1&n&&(t.TgZ(0,"div",4),t.YNc(1,e,2,1,"p",5),t.qZA()),2&n){const c=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",c.errorMessages)}}function b(n,l){if(1&n){const c=t.EpF();t.TgZ(0,"div",2)(1,"div",7),t.NdJ("click",function(){t.CHM(c);const h=t.oxw(2);return t.KtG(h.toggleErrors())}),t._uU(2),t.TgZ(3,"span"),t._uU(4,"(Click here to show)"),t.qZA()(),t.YNc(5,g,2,1,"div",8),t._UZ(6,"div",6),t.qZA()}if(2&n){const c=t.oxw(2);t.xp6(2),t.hij(" Sorry, system find ",c.errorMessages.length," errors. "),t.xp6(3),t.Q6J("ngIf",c.showErrors)}}function A(n,l){if(1&n&&(t.ynx(0),t.YNc(1,x,6,1,"div",1),t.YNc(2,b,7,2,"div",1),t.BQk()),2&n){const c=t.oxw();t.xp6(1),t.Q6J("ngIf",1===c.errorMessages.length),t.xp6(1),t.Q6J("ngIf",c.errorMessages.length>1)}}function p(n,l){if(1&n&&(t.TgZ(0,"div",2)(1,"div",9),t._uU(2," Success "),t.qZA(),t.TgZ(3,"div",10)(4,"p"),t._uU(5),t.qZA()(),t._UZ(6,"div",6),t.qZA()),2&n){const c=t.oxw();t.xp6(5),t.Oqu(c.successMessage)}}let M=(()=>{const l=class{constructor(){this.errorMessages=[],this.successMessage="",this.showErrors=!1}toggleErrors(){this.showErrors=!this.showErrors}};let n=l;return l.\u0275fac=function(h){return new(h||l)},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-alert"]],inputs:{errorMessages:"errorMessages",successMessage:"successMessage"},decls:2,vars:2,consts:[[4,"ngIf"],["role","alert",4,"ngIf"],["role","alert"],[1,"bg-red-500","text-white","font-bold","rounded-t","px-4","py-2"],[1,"border","border-t-0","border-red-400","rounded-b","bg-red-100","px-4","py-3","text-red-700"],[4,"ngFor","ngForOf"],[1,"mb-4"],[1,"bg-red-500","text-white","font-bold","rounded-t","px-4","py-2","cursor-pointer",3,"click"],["class","border border-t-0 border-red-400 rounded-b bg-red-100 px-4 py-3 text-red-700",4,"ngIf"],[1,"bg-green-500","text-white","font-bold","rounded-t","px-4","py-2"],[1,"border","border-t-0","border-green-400","rounded-b","bg-green-100","px-4","py-3","text-green-700"]],template:function(h,q){1&h&&(t.YNc(0,A,3,2,"ng-container",0),t.YNc(1,p,7,1,"div",1)),2&h&&(t.Q6J("ngIf",q.errorMessages.length>0),t.xp6(1),t.Q6J("ngIf",""!==q.successMessage))},dependencies:[_.sg,_.O5]}),n})()},507:(y,f,r)=>{r.d(f,{u:()=>x});var t=r(6895),_=r(2605),Z=r(1571);let x=(()=>{const g=class{};let e=g;return g.\u0275fac=function(p){return new(p||g)},g.\u0275mod=Z.oAB({type:g}),g.\u0275inj=Z.cJS({imports:[t.ez,_.Bz]}),e})()},1161:(y,f,r)=>{r.r(f),r.d(f,{PurchaseRequestModule:()=>S});var t=r(6895),_=r(2340),Z=r(1822),x=r(5439),e=r(1571),g=r(6690),b=r(6548),A=r(2605),p=r(433),M=r(12),n=r(4909),l=r(9602);function c(a,u){1&a&&(e.TgZ(0,"a",48),e._uU(1," New Purchase Request "),e.qZA())}const T=function(a){return["/purchase-requests/",a]};function h(a,u){if(1&a&&(e.TgZ(0,"div",58)(1,"a",59)(2,"span",60),e._UZ(3,"i",61),e.qZA(),e.TgZ(4,"span",62),e._uU(5," View "),e.qZA()()()),2&a){const i=e.oxw().$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(1,T,i.id))}}function q(a,u){if(1&a&&(e.TgZ(0,"tr")(1,"td",49),e._uU(2),e.qZA(),e.TgZ(3,"td",49),e._uU(4),e.qZA(),e.TgZ(5,"td",49),e._uU(6),e.qZA(),e.TgZ(7,"td",49),e._uU(8),e.qZA(),e.TgZ(9,"td",49),e._uU(10),e.qZA(),e.TgZ(11,"td",49),e._uU(12),e.qZA(),e.TgZ(13,"td",49)(14,"div",50),e._uU(15),e.qZA()(),e.TgZ(16,"td",49)(17,"div"),e._uU(18),e.qZA()(),e.TgZ(19,"td",51)(20,"div",52)(21,"div",53)(22,"button",54),e._UZ(23,"i",55),e.qZA(),e.TgZ(24,"div",56),e.YNc(25,h,6,3,"div",57),e.qZA()()()()()),2&a){const i=u.$implicit,d=e.oxw();e.xp6(2),e.hij(" ",null==i.entity?null:i.entity.name," "),e.xp6(2),e.hij(" ",i.pr_number," "),e.xp6(2),e.hij(" ",i.pr_name," "),e.xp6(2),e.hij(" ",i.pr_date_formatted," "),e.xp6(2),e.AsE(" ",i.amount_in_document_currency_formatted," ",i.currency," "),e.xp6(2),e.AsE(" ",i.amount_in_local_currency_formatted," ",i.local_currency," "),e.xp6(3),e.AsE(" ",i.approval_level_approved," / ",i.approval_level_required," "),e.xp6(2),e.Gre("badge badge-sm badge-",i.status_color," badge-outline"),e.xp6(1),e.hij(" ",i.status_alias," "),e.xp6(7),e.Q6J("ngIf",d.permissionService.hasPermission("WorkSpace - Can Show Purchase Request"))}}function C(a,u){1&a&&(e.TgZ(0,"tr")(1,"td",63),e._uU(2," No purchase requests found "),e.qZA()())}function R(a,u){if(1&a){const i=e.EpF();e.TgZ(0,"app-pagination",64),e.NdJ("selectedPage",function(o){e.CHM(i);const s=e.oxw();return e.KtG(s.selectedPage(o))}),e.qZA()}if(2&a){const i=e.oxw();e.Q6J("perPage",i.perPage)("totalItems",i.totalItems)("currentPage",i.page)}}let w=(()=>{const u=class{constructor(d,o){this.headerService=d,this.permissionService=o,this.purchaseRequests=[],this.loading=!1,this.errorMessages=[],this.successMessage="",this.page=1,this.totalItems=0,this.perPage=10,this.to="",this.from="",this.filters={entity_name:"",pr_number:"",pr_date:"",status:""},this.headerService.setupHeader([{title:"Work Space"},{title:"Purchase Requests"}])}ngOnInit(){this.getPurchaseRequests()}getPurchaseRequests(){this.loading=!0;const d={...this.filters};d.pr_date&&(d.pr_date=x(d.pr_date).format("YYYY-MM-DD")),Z.Z.get(`${_.N.api_url}/work-space/purchase-requests`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${window.localStorage.getItem(_.N.api_token_identifier)}`},params:{page:this.page,per_page:this.perPage,module:"purchase_request",...d}}).then(o=>{if(o.data.error){let s=[];return s.push(o.data.error_message),this.errorMessages=s,window.scrollTo(0,0),this.loading=!1,void this.clearMessages()}this.purchaseRequests=o.data.purchase_requests.data,this.totalItems=o.data.purchase_requests.total,this.to=o.data.purchase_requests.to,this.from=o.data.purchase_requests.from,this.loading=!1}).catch(o=>{console.error(o),422==o.response.status?Object.keys(o.response.data.errors).forEach(s=>{this.errorMessages.push(o.response.data.errors[s])}):this.errorMessages.push("Sorry, something went wrong. Please try again later."),window.scrollTo(0,0),this.loading=!1,this.clearMessages()})}selectedPage(d){this.page=d,this.getPurchaseRequests()}searchPurchaseRequests(){this.page=1,this.getPurchaseRequests()}clearMessages(){setTimeout(()=>{this.errorMessages=[],this.successMessage=""},3500)}resetFilters(){this.filters={pr_number:"",pr_date:"",amount:"",status:""},this.getPurchaseRequests()}};let a=u;return u.\u0275fac=function(o){return new(o||u)(e.Y36(g.r),e.Y36(b.$))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-purchase-request"]],decls:88,vars:17,consts:[[1,"container-fixed"],[1,"flex","flex-wrap","items-center","lg:items-end","justify-between","gap-5","pb-7.5"],[1,"flex","flex-col","justify-center","gap-2"],[1,"text-xl","font-medium","leading-none","text-gray-900"],[1,"flex","items-center","gap-2.5"],["class","btn btn-sm btn-success","routerLink","/purchase-requests/create",4,"ngIf"],[3,"errorMessages","successMessage"],[1,"mb-4"],[1,"text-lg","font-medium","leading-none","text-gray-900"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],["for","entity_name",1,"text-sm","font-normal","text-gray-700"],["type","text","id","entity_name","placeholder","Entity Name","name","entity_name",1,"input","input-sm",3,"ngModel","ngModelChange"],["for","pr_number",1,"text-sm","font-normal","text-gray-700"],["type","text","id","pr_number","placeholder","PR Number","name","pr_number",1,"input","input-sm",3,"ngModel","ngModelChange"],["for","pr_date",1,"text-sm","font-normal","text-gray-700"],["name","pr_date","placeholder","Select PR Date",1,"input","input-sm",3,"matDatepicker","ngModel","click","ngModelChange"],["pr_date",""],["for","status",1,"text-sm","font-normal","text-gray-700"],["id","status","name","status",1,"input","input-sm",3,"ngModel","ngModelChange"],["value",""],["value","Draft"],["value","Submitted"],["value","Approved"],["value","Rejected"],["value","Cancelled"],[1,"w-full","mt-2","flex","justify-end","gap-2"],[1,"btn","btn-sm","btn-light",3,"disabled","click"],[1,"btn","btn-sm","btn-primary",3,"disabled","click"],[1,"w-full","my-4","border-t","border-gray-300","mb-8"],[1,"grid","gap-5","lg:gap-7.5"],[1,"card","card-grid","min-w-full"],[1,"card-header","flex-wrap","gap-2"],[1,"card-title","font-medium","text-sm"],[1,"card-body"],["data-datatable","true","data-datatable-page-size","20"],[1,"scrollable-x-auto"],["data-datatable-table","true",1,"table","table-auto","table-border"],[1,"min-w-[250px]"],[1,"min-w-[100px]"],[1,"min-w-[180px]"],[1,"min-w-[150px]"],[1,"w-[60px]"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"card-footer","justify-center","md:justify-between","flex-col","md:flex-row","gap-5","text-gray-600","text-2sm","font-medium"],[1,"flex","items-center","gap-2","order-2","md:order-1"],[1,"flex","items-center","gap-4","order-1","md:order-2"],[3,"perPage","totalItems","currentPage","selectedPage",4,"ngIf"],["routerLink","/purchase-requests/create",1,"btn","btn-sm","btn-success"],[1,"text-gray-800","font-normal"],[1,"badge","badge-sm","badge-danger","badge-outline"],[1,"text-center"],["data-menu","true",1,"menu","flex-inline"],["data-menu-item-offset","0, 10px","data-menu-item-placement","bottom-end","data-menu-item-placement-rtl","bottom-start","data-menu-item-toggle","dropdown","data-menu-item-trigger","click|lg:click",1,"menu-item"],[1,"menu-toggle","btn","btn-sm","btn-icon","btn-light","btn-clear"],[1,"ki-filled","ki-dots-vertical"],["data-menu-dismiss","true",1,"menu-dropdown","menu-default","w-full","max-w-[175px]"],["class","menu-item",4,"ngIf"],[1,"menu-item"],[1,"menu-link",3,"routerLink"],[1,"menu-icon"],[1,"ki-filled","ki-setting-2"],[1,"menu-title"],["colspan","7",1,"text-center","text-gray-500","font-normal"],[3,"perPage","totalItems","currentPage","selectedPage"]],template:function(o,s){if(1&o){const U=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4," Purchase Requests "),e.qZA()(),e.TgZ(5,"div",4),e.YNc(6,c,2,0,"a",5),e.qZA()(),e._UZ(7,"app-alert",6),e.TgZ(8,"div",7)(9,"h2",8),e._uU(10," Search "),e.qZA(),e.TgZ(11,"div",9)(12,"div")(13,"label",10),e._uU(14,"Entity Name:"),e.qZA(),e._UZ(15,"br"),e.TgZ(16,"input",11),e.NdJ("ngModelChange",function(m){return s.filters.entity_name=m}),e.qZA()(),e.TgZ(17,"div")(18,"label",12),e._uU(19,"PR Number:"),e.qZA(),e._UZ(20,"br"),e.TgZ(21,"input",13),e.NdJ("ngModelChange",function(m){return s.filters.pr_number=m}),e.qZA()(),e.TgZ(22,"div")(23,"label",14),e._uU(24,"PR Date:"),e.qZA(),e._UZ(25,"br"),e.TgZ(26,"input",15),e.NdJ("click",function(){e.CHM(U);const m=e.MAs(28);return e.KtG(m.open())})("ngModelChange",function(m){return s.filters.pr_date=m}),e.qZA(),e._UZ(27,"mat-datepicker",null,16),e.qZA(),e.TgZ(29,"div")(30,"label",17),e._uU(31,"Status:"),e.qZA(),e._UZ(32,"br"),e.TgZ(33,"select",18),e.NdJ("ngModelChange",function(m){return s.filters.status=m}),e.TgZ(34,"option",19),e._uU(35,"All"),e.qZA(),e.TgZ(36,"option",20),e._uU(37,"Draft"),e.qZA(),e.TgZ(38,"option",21),e._uU(39,"Submitted"),e.qZA(),e.TgZ(40,"option",22),e._uU(41,"Approved"),e.qZA(),e.TgZ(42,"option",23),e._uU(43,"Rejected"),e.qZA(),e.TgZ(44,"option",24),e._uU(45,"Cancelled"),e.qZA()()()(),e.TgZ(46,"div",25)(47,"button",26),e.NdJ("click",function(){return s.resetFilters()}),e._uU(48," Clear Filters "),e.qZA(),e.TgZ(49,"button",27),e.NdJ("click",function(){return s.searchPurchaseRequests()}),e._uU(50),e.qZA()()(),e._UZ(51,"hr",28),e.qZA(),e.TgZ(52,"div",0)(53,"div",29)(54,"div",30)(55,"div",31)(56,"h3",32),e._uU(57),e.qZA()(),e.TgZ(58,"div",33)(59,"div",34)(60,"div",35)(61,"table",36)(62,"thead")(63,"tr")(64,"th",37),e._uU(65," Entity Name "),e.qZA(),e.TgZ(66,"th",38),e._uU(67," PR Number "),e.qZA(),e.TgZ(68,"th",39),e._uU(69," PR Name "),e.qZA(),e.TgZ(70,"th",39),e._uU(71," PR Date "),e.qZA(),e.TgZ(72,"th",40),e._uU(73," Amount "),e.qZA(),e.TgZ(74,"th",40),e._uU(75," Amount in Local "),e.qZA(),e.TgZ(76,"th",40),e._uU(77," Approval Level "),e.qZA(),e.TgZ(78,"th",40),e._uU(79," Status "),e.qZA(),e._UZ(80,"th",41),e.qZA()(),e.TgZ(81,"tbody"),e.YNc(82,q,26,15,"tr",42),e.YNc(83,C,3,0,"tr",43),e.qZA()()(),e.TgZ(84,"div",44),e._UZ(85,"div",45),e.TgZ(86,"div",46),e.YNc(87,R,1,3,"app-pagination",47),e.qZA()()()()()()()}if(2&o){const U=e.MAs(28);e.xp6(6),e.Q6J("ngIf",s.permissionService.hasPermission("WorkSpace - Can Create Purchase Request")),e.xp6(1),e.Q6J("errorMessages",s.errorMessages)("successMessage",s.successMessage),e.xp6(9),e.Q6J("ngModel",s.filters.entity_name),e.xp6(5),e.Q6J("ngModel",s.filters.pr_number),e.xp6(5),e.Q6J("matDatepicker",U)("ngModel",s.filters.pr_date),e.xp6(7),e.Q6J("ngModel",s.filters.status),e.xp6(14),e.Q6J("disabled",s.loading),e.xp6(2),e.Q6J("disabled",s.loading),e.xp6(1),e.hij(" ",s.loading?"Loading...":"Search"," "),e.xp6(7),e.lnq(" Showing ",s.from," to ",s.to," of ",s.totalItems," purchase requests "),e.xp6(25),e.Q6J("ngForOf",s.purchaseRequests),e.xp6(1),e.Q6J("ngIf",0==(null==s.purchaseRequests?null:s.purchaseRequests.length)),e.xp6(4),e.Q6J("ngIf",!s.loading)}},dependencies:[t.sg,t.O5,A.rH,p.YN,p.Kr,p.Fj,p.EJ,p.JJ,p.On,M.w,n.Q,l.Mq,l.hl]}),a})();var J=r(5730),E=r(507),N=r(4859),I=r(4144),P=r(3238),O=r(9549);const Q=[{path:"",component:w}];let S=(()=>{const u=class{};let a=u;return u.\u0275fac=function(o){return new(o||u)},u.\u0275mod=e.oAB({type:u}),u.\u0275inj=e.cJS({providers:[{provide:P.Ad,useValue:"en-GB"}],imports:[t.ez,A.Bz.forChild(Q),p.u5,J.n,E.u,N.ot,I.c,l.FA,P.XK,O.lN]}),a})()}}]);