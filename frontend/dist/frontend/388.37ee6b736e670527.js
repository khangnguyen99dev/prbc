"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[388],{5388:(S,f,o)=>{o.r(f),o.d(f,{NotificationModule:()=>F});var g=o(6895),c=o(2605),p=o(1822),d=o(2340),t=o(1571),h=o(6690),x=o(2013),v=o(12),y=o(4909);function Z(e,n){1&e&&(t.TgZ(0,"div",22),t.O4$(),t.TgZ(1,"svg",23),t._UZ(2,"path",24),t.qZA(),t.kcU(),t.TgZ(3,"span",25),t._uU(4,"Check icon"),t.qZA()())}function k(e,n){1&e&&(t.TgZ(0,"div",26),t.O4$(),t.TgZ(1,"svg",23),t._UZ(2,"path",27),t.qZA(),t.kcU(),t.TgZ(3,"span",25),t._uU(4,"Error icon"),t.qZA()())}function b(e,n){1&e&&(t.TgZ(0,"div",28),t.O4$(),t.TgZ(1,"svg",23),t._UZ(2,"path",29),t.qZA(),t.kcU(),t.TgZ(3,"span",25),t._uU(4,"Warning icon"),t.qZA()())}function w(e,n){if(1&e&&(t.TgZ(0,"span",30),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.hij(" (Created at ",t.xi3(2,1,i.created_at,"d/M/yyyy H:mm"),") ")}}function T(e,n){if(1&e&&(t.TgZ(0,"span",30),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&e){const i=t.oxw().$implicit;t.xp6(1),t.AsE(" (Created at ",t.xi3(2,2,i.created_at,"d/M/yyyy H:mm"),") - (Read at ",t.xi3(3,5,i.read_at,"d/M/yyyy H:mm"),") ")}}function _(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"div",31),t.NdJ("click",function(){t.CHM(i);const s=t.oxw().$implicit,r=t.oxw();return t.KtG(r.navigateTo(s))}),t.O4$(),t.TgZ(1,"svg",32),t._UZ(2,"path",33),t.qZA()()}}function M(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"button",34),t.NdJ("click",function(){t.CHM(i);const s=t.oxw().$implicit,r=t.oxw();return t.KtG(r.markAsRead(s.id))}),t.TgZ(1,"span",25),t._uU(2,"Close"),t.qZA(),t.O4$(),t.TgZ(3,"svg",35),t._UZ(4,"path",36),t.qZA()()}}function N(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"div",14),t.YNc(2,Z,5,0,"div",15),t.YNc(3,k,5,0,"div",16),t.YNc(4,b,5,0,"div",17),t.TgZ(5,"div",18),t._uU(6),t.YNc(7,w,3,4,"span",19),t.YNc(8,T,4,8,"span",19),t.qZA(),t.YNc(9,_,3,0,"div",20),t.YNc(10,M,5,0,"button",21),t.qZA(),t.BQk()),2&e){const i=n.$implicit;t.xp6(1),t.MGl("id","toast-",i.data.type_icon,""),t.xp6(1),t.Q6J("ngIf","success"===i.data.type_icon),t.xp6(1),t.Q6J("ngIf","error"===i.data.type_icon),t.xp6(1),t.Q6J("ngIf","warning"===i.data.type_icon),t.xp6(2),t.hij(" ",i.data.message," "),t.xp6(1),t.Q6J("ngIf",!i.read_at),t.xp6(1),t.Q6J("ngIf",i.read_at),t.xp6(1),t.Q6J("ngIf",!i.read_at&&i.data.router_link),t.xp6(1),t.Q6J("ngIf",!i.read_at)}}function A(e,n){1&e&&(t.TgZ(0,"div",37),t._uU(1," No notifications found "),t.qZA())}function C(e,n){if(1&e){const i=t.EpF();t.TgZ(0,"app-pagination",38),t.NdJ("selectedPage",function(s){t.CHM(i);const r=t.oxw();return t.KtG(r.selectedPage(s))}),t.qZA()}if(2&e){const i=t.oxw();t.Q6J("perPage",i.perPage)("totalItems",i.totalItems)("currentPage",i.page)}}const u=function(){return["/notifications"]},I=function(){return{tab:"unread"}},j=function(){return{tab:"read"}};let P=(()=>{const n=class{constructor(a,s,r,l){this.route=a,this.router=s,this.headerService=r,this.notificationService=l,this.currentTab="unread",this.page=1,this.totalItems=0,this.perPage=10,this.notifications=[],this.loading=!1,this.errorMessages=[],this.successMessage="",this.headerService.setupHeader([{title:"Notifications"}])}ngOnInit(){this.route.queryParams.subscribe(a=>{this.currentTab=a.tab??"unread",this.getNotifications()})}getNotifications(){this.loading=!0,p.Z.get(`${d.N.api_url}/notifications`,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${window.localStorage.getItem(d.N.api_token_identifier)}`},params:{page:this.page,per_page:this.perPage,tab:this.currentTab}}).then(a=>{if(a.data.error)return this.errorMessages.push(a.data.error_message),window.scrollTo(0,0),this.loading=!1,void this.clearMessages();this.notifications=a.data.notifications.data,this.totalItems=a.data.notifications.total,this.loading=!1}).catch(a=>{console.error(a),422==a.response.status?Object.keys(a.response.data.errors).forEach(s=>{this.errorMessages.push(a.response.data.errors[s])}):this.errorMessages.push("Sorry, something went wrong. Please try again later."),window.scrollTo(0,0),this.loading=!1,this.clearMessages()})}markAsRead(a,s=!0){p.Z.post(`${d.N.api_url}/notifications/mark-as-read`,{id:a},{headers:{Authorization:`Bearer ${window.localStorage.getItem(d.N.api_token_identifier)}`}}).then(r=>{if(r.data.error)return this.errorMessages.push(r.data.error_message),window.scrollTo(0,0),this.loading=!1,void this.clearMessages();s&&(this.successMessage=r.data.success_message,this.page=1,this.getNotifications(),window.scrollTo(0,0),setTimeout(()=>{this.successMessage="",this.loading=!1},3500)),this.notificationService.fetchNotifications()}).catch(r=>{console.error(r),422==r.response.status?Object.keys(r.response.data.errors).forEach(l=>{this.errorMessages.push(r.response.data.errors[l])}):this.errorMessages.push("Sorry, something went wrong. Please try again later."),window.scrollTo(0,0),this.loading=!1,this.clearMessages()})}clearMessages(){setTimeout(()=>{this.successMessage=""},3500)}selectedPage(a){this.page=a,this.getNotifications()}navigateTo(a){this.markAsRead(a.id,!1),this.router.navigate([a?.data?.router_link])}};let e=n;return n.\u0275fac=function(s){return new(s||n)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(h.r),t.Y36(x.g))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-notification"]],decls:19,vars:17,consts:[[1,"container-fixed"],[1,"flex","items-center","flex-wrap","md:flex-nowrap","lg:items-end","justify-between","border-b","border-b-gray-200","dark:border-b-coal-100","gap-3","lg:gap-6","mb-2"],[1,"grid"],[1,"scrollable-x-auto"],["data-menu","true",1,"menu","gap-3"],[1,"menu-item","border-b-2","border-b-transparent","menu-item-active:border-b-primary","menu-item-here:border-b-primary"],["tabindex","0",1,"menu-link","gap-1.5","pb-2","lg:pb-4","px-2",3,"routerLink","queryParams"],[1,"menu-title","text-nowrap","font-medium","text-sm","text-gray-700","menu-item-active:text-primary","menu-item-active:font-semibold","menu-item-here:text-primary","menu-item-here:font-semibold","menu-item-show:text-primary","menu-link-hover:text-primary"],[3,"errorMessages","successMessage"],[1,"mt-4"],[4,"ngFor","ngForOf"],["class","text-center text-gray-500 font-normal mt-4",4,"ngIf"],[1,"flex","items-center","justify-end","gap-4","order-1","md:order-2"],[3,"perPage","totalItems","currentPage","selectedPage",4,"ngIf"],["role","alert",1,"flex","items-center","w-full","p-4","mb-4","text-gray-500","bg-white","rounded-lg","shadow","dark:text-gray-400","dark:bg-gray-800",3,"id"],["class","inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-green-500 bg-green-100 rounded-lg dark:bg-green-800 dark:text-green-200",4,"ngIf"],["class","inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-red-500 bg-red-100 rounded-lg dark:bg-red-800 dark:text-red-200",4,"ngIf"],["class","inline-flex items-center justify-center flex-shrink-0 w-8 h-8 text-orange-500 bg-orange-100 rounded-lg dark:bg-orange-700 dark:text-orange-200",4,"ngIf"],[1,"ms-3","text-sm","font-normal","text-black"],["class","text-xs text-gray-500",4,"ngIf"],["style","cursor: pointer;",3,"click",4,"ngIf"],["type","button","class","ms-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-1.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700","data-dismiss-target","#toast-success","aria-label","Close",3,"click",4,"ngIf"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","text-green-500","bg-green-100","rounded-lg","dark:bg-green-800","dark:text-green-200"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"],[1,"sr-only"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","text-red-500","bg-red-100","rounded-lg","dark:bg-red-800","dark:text-red-200"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 11.793a1 1 0 1 1-1.414 1.414L10 11.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L8.586 10 6.293 7.707a1 1 0 0 1 1.414-1.414L10 8.586l2.293-2.293a1 1 0 0 1 1.414 1.414L11.414 10l2.293 2.293Z"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","text-orange-500","bg-orange-100","rounded-lg","dark:bg-orange-700","dark:text-orange-200"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM10 15a1 1 0 1 1 0-2 1 1 0 0 1 0 2Zm1-4a1 1 0 0 1-2 0V6a1 1 0 0 1 2 0v5Z"],[1,"text-xs","text-gray-500"],[2,"cursor","pointer",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"size-6"],["stroke-linecap","round","stroke-linejoin","round","d","M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244"],["type","button","data-dismiss-target","#toast-success","aria-label","Close",1,"ms-auto","-mx-1.5","-my-1.5","bg-white","text-gray-400","hover:text-gray-900","rounded-lg","focus:ring-2","focus:ring-gray-300","p-1.5","hover:bg-gray-100","inline-flex","items-center","justify-center","h-8","w-8","dark:text-gray-500","dark:hover:text-white","dark:bg-gray-800","dark:hover:bg-gray-700",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"text-center","text-gray-500","font-normal","mt-4"],[3,"perPage","totalItems","currentPage","selectedPage"]],template:function(s,r){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"a",6)(7,"span",7),t._uU(8," Unread "),t.qZA()()(),t.TgZ(9,"div",5)(10,"a",6)(11,"span",7),t._uU(12," Read "),t.qZA()()()()()()(),t._UZ(13,"app-alert",8),t.TgZ(14,"div",9),t.YNc(15,N,11,9,"ng-container",10),t.YNc(16,A,2,0,"div",11),t.qZA(),t.TgZ(17,"div",12),t.YNc(18,C,1,3,"app-pagination",13),t.qZA()()),2&s&&(t.xp6(5),t.ekj("active","unread"===r.currentTab),t.xp6(1),t.Q6J("routerLink",t.DdM(13,u))("queryParams",t.DdM(14,I)),t.xp6(3),t.ekj("active","read"===r.currentTab),t.xp6(1),t.Q6J("routerLink",t.DdM(15,u))("queryParams",t.DdM(16,j)),t.xp6(3),t.Q6J("errorMessages",r.errorMessages)("successMessage",r.successMessage),t.xp6(2),t.Q6J("ngForOf",r.notifications),t.xp6(1),t.Q6J("ngIf",0==r.notifications.length),t.xp6(2),t.Q6J("ngIf",!r.loading))},dependencies:[g.sg,g.O5,c.rH,v.w,y.Q,g.uU]}),e})();var U=o(433),J=o(5730),Q=o(507),Y=o(4859),$=o(4144),L=o(9602),m=o(3238),O=o(9549);const B=[{path:"",component:P}];let F=(()=>{const n=class{};let e=n;return n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[{provide:m.Ad,useValue:"en-GB"}],imports:[g.ez,c.Bz.forChild(B),U.u5,J.n,Q.u,Y.ot,$.c,L.FA,m.XK,O.lN,c.Bz]}),e})()}}]);